"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CciNistMapping = void 0;
const CciNistMappingData_1 = require("./CciNistMappingData");
const CciNistMappingItem_1 = require("./CciNistMappingItem");
class CciNistMapping {
    constructor() {
        this.data = [];
        if (typeof CciNistMappingData_1.data === 'object') {
            Object.entries(CciNistMappingData_1.data).forEach((item) => {
                this.data.push(new CciNistMappingItem_1.CciNistMappingItem(item[0], item[1]));
            });
        }
    }
    nistFilter(identifiers, defaultNist, collapse = true) {
        const DEFAULT_NIST_TAG = defaultNist;
        const matches = [];
        identifiers.forEach((id) => {
            const item = this.data.find((element) => element.cci === id);
            if (item && item.nistId) {
                if (collapse) {
                    if (matches.indexOf(item.nistId) === -1) {
                        matches.push(item.nistId);
                    }
                }
                else {
                    matches.push(item.nistId);
                }
            }
        });
        if (matches.length === 0) {
            return DEFAULT_NIST_TAG;
        }
        return matches;
    }
}
exports.CciNistMapping = CciNistMapping;
//# sourceMappingURL=CciNistMapping.js.map