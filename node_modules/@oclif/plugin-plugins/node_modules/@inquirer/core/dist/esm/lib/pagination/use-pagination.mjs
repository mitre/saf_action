import { useRef } from '../use-ref.mjs';
import { readlineWidth } from '../utils.mjs';
import { makeTheme } from '../make-theme.mjs';
import { lines } from './lines.mjs';
import { finite, infinite } from './position.mjs';
export function usePagination({ items, active, renderItem, pageSize, loop = true, theme: defaultTheme, }) {
    const state = useRef({ position: 0, lastActive: 0 });
    const theme = makeTheme(defaultTheme);
    const position = loop
        ? infinite({
            active,
            lastActive: state.current.lastActive,
            total: items.length,
            pageSize,
            pointer: state.current.position,
        })
        : finite({
            active,
            total: items.length,
            pageSize,
        });
    state.current.position = position;
    state.current.lastActive = active;
    const visibleLines = lines({
        items,
        width: readlineWidth(),
        renderItem,
        active,
        position,
        pageSize,
    }).join('\n');
    if (items.length > pageSize) {
        return `${visibleLines}\n${theme.style.help('(Use arrow keys to reveal more choices)')}`;
    }
    return visibleLines;
}
